{% extends 'blog/entry_view.html' %}

{% block comments %}
    <section class="mb-5">
        <div class="card bg-light">
            <div class="card-body">
                <!-- Comment form-->
                {% if request.user.is_authenticated %}
                    <form class="mb-4" action="" method="POST">
                        {% csrf_token %}
                        <textarea class="form-control" name="comment" rows="3" placeholder="Únete a la discusión!"></textarea>
                        <input type="submit" class="btn btn-primary m-2" value="Enviar">
                    </form>
                {% else %}
                    <p class="text-center text-black-50">Inicia sesión para dejar un comentario</p>
                {% endif %}
                {% comment %} <form action="" class="mb-4" method="POST">
                    {{form}}
                    <input type="submit" value="Enviar">
                </form> {% endcomment %}
                {% comment %} <form action="" class="mb-4">
                    <textarea
                        class="form-control"
                        name="comment"
                        placeholder="Únete a la discusión!"
                        rows="3"
                        aria-label="Dejar comentario"
                    />
                    <input type="submit" class="btn btn-primary" value="Enviar" />
                    </form> {% endcomment %}
                <!-- Comment with nested comments-->
                {% if comments %}
                {% for comment in comments %}
                    <div class="d-flex mb-4">
                        <!-- Parent comment-->
                        <div class="flex-shrink-0">
                            {% if comment.userdata.avatar %}
                                <img class="rounded-circle" src={{comment.userdata.avatar.url}} height="50" width="50" alt="avatar" />
                            {% else %}
                                <img class="rounded-circle" src="https://dummyimage.com/50x50/ced4da/6c757d.jpg" alt="avatar" />
                            {% endif %}
                        </div>
                        <div class="ms-3">
                            <div class="fw-bold">{{comment.userdata.user.username}}</div>
                            {{comment.comment}}
                            <div class="d-flex">
                                <a href="" class="text-muted mx-2">Responder</a>
                                {% if comment.userdata.user.username == request.user.username %}
                                    <span> | </span>
                                    <a href={% url "delete_comment" comment.id %} class="text-muted mx-2">Editar</a>
                                    <span> | </span>
                                    <a href={% url "delete_comment" comment.id %} class="text-muted mx-2">Eliminar</a>
                                {% endif %}
                            </div>
                            {% comment %} <!-- Child comment 1-->
                            <div class="d-flex mt-4">
                                <div class="flex-shrink-0"><img class="rounded-circle" src="https://dummyimage.com/50x50/ced4da/6c757d.jpg" alt="..." /></div>
                                <div class="ms-3">
                                    <div class="fw-bold">Commenter Name</div>
                                    And under those conditions, you cannot establish a capital-market evaluation of that enterprise. You can't get investors.
                                </div>
                            </div>
                            <!-- Child comment 2-->
                            <div class="d-flex mt-4">
                                <div class="flex-shrink-0"><img class="rounded-circle" src="https://dummyimage.com/50x50/ced4da/6c757d.jpg" alt="..." /></div>
                                <div class="ms-3">
                                    <div class="fw-bold">Commenter Name</div>
                                    When you put money directly to a problem, it makes a good headline.
                                </div>
                            </div> {% endcomment %}
                        </div>
                    </div>
                {% endfor %}
                {% else %}
                    <p class="text-center text-black-50">Aún no hay comentarios.</p>
                {% endif %}
            </div>
        </div>
    </section>
{% endblock comments %}
       
